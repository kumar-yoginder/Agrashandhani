"""
MalwareBazaar threat intelligence source
"""
from sources.base import Source
from clients import RateLimitedClient
from config import MB_API_URL


bazaar_client = RateLimitedClient(max_retries=3)


class MalwareBazaarSource(Source):
    """MalwareBazaar source handler"""
    
    def __init__(self):
        super().__init__("malwarebazaar")
    
    def query(self, ioc_type: str, value: str) -> dict:
        """Query MalwareBazaar API"""
        if not ioc_type.startswith("hash_"):
            return {"error": "MalwareBazaar only supports hashes"}
        
        return bazaar_client.request(
            "POST",
            MB_API_URL,
            data={"query": "get_info", "hash": value}
        )
